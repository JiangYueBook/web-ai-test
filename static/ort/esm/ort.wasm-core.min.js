/*!
 * ONNX Runtime Web v1.17.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var pt=Object.defineProperty;var Dn=Object.getOwnPropertyDescriptor;var Un=Object.getOwnPropertyNames;var Ln=Object.prototype.hasOwnProperty;var U=(o,r)=>()=>(o&&(r=o(o=0)),r);var Mn=(o,r)=>()=>(r||o((r={exports:{}}).exports,r),r.exports),qe=(o,r)=>{for(var n in r)pt(o,n,{get:r[n],enumerable:!0})},Rn=(o,r,n,u)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of Un(r))!Ln.call(o,a)&&a!==n&&pt(o,a,{get:()=>r[a],enumerable:!(u=Dn(r,a))||u.enumerable});return o};var mt=o=>Rn(pt({},"__esModule",{value:!0}),o);var Xe,ge,Ae,Je,Ze=U(()=>{"use strict";Xe=new Map,ge=[],Ae=(o,r,n)=>{if(r&&typeof r.init=="function"&&typeof r.createInferenceSessionHandler=="function"){let u=Xe.get(o);if(u===void 0)Xe.set(o,{backend:r,priority:n});else{if(u.priority>n)return;if(u.priority===n&&u.backend!==r)throw new Error(`cannot register backend "${o}" using priority ${n}`)}if(n>=0){let a=ge.indexOf(o);a!==-1&&ge.splice(a,1);for(let d=0;d<ge.length;d++)if(Xe.get(ge[d]).priority<=n){ge.splice(d,0,o);return}ge.push(o)}return}throw new TypeError("not a valid backend")},Je=async o=>{let r=o.length===0?ge:o,n=[];for(let u of r){let a=Xe.get(u);if(a){if(a.initialized)return a.backend;if(a.aborted)continue;let d=!!a.initPromise;try{return d||(a.initPromise=a.backend.init(u)),await a.initPromise,a.initialized=!0,a.backend}catch(f){d||n.push({name:u,err:f}),a.aborted=!0}finally{delete a.initPromise}}}throw new Error(`no available backend found. ERR: ${n.map(u=>`[${u.name}] ${u.err}`).join(", ")}`)}});var Qt=U(()=>{"use strict";Ze()});var er,tr=U(()=>{"use strict";er="1.17.0"});var rr,we,ht=U(()=>{"use strict";tr();rr="warning",we={wasm:{},webgl:{},webgpu:{},versions:{common:er},set logLevel(o){if(o!==void 0){if(typeof o!="string"||["verbose","info","warning","error","fatal"].indexOf(o)===-1)throw new Error(`Unsupported logging level: ${o}`);rr=o}},get logLevel(){return rr}};Object.defineProperty(we,"logLevel",{enumerable:!0})});var N,nr=U(()=>{"use strict";ht();N=we});var or,ir,ar=U(()=>{"use strict";or=(o,r)=>{let n=document.createElement("canvas");n.width=o.dims[3],n.height=o.dims[2];let u=n.getContext("2d");if(u!=null){let a,d;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(a=o.dims[2],d=o.dims[3]):(a=o.dims[3],d=o.dims[2]);let f=r?.format!==void 0?r.format:"RGB",m=r?.norm,h,l;m===void 0||m.mean===void 0?h=[255,255,255,255]:typeof m.mean=="number"?h=[m.mean,m.mean,m.mean,m.mean]:(h=[m.mean[0],m.mean[1],m.mean[2],0],m.mean[3]!==void 0&&(h[3]=m.mean[3])),m===void 0||m.bias===void 0?l=[0,0,0,0]:typeof m.bias=="number"?l=[m.bias,m.bias,m.bias,m.bias]:(l=[m.bias[0],m.bias[1],m.bias[2],0],m.bias[3]!==void 0&&(l[3]=m.bias[3]));let y=d*a,b=0,w=y,E=y*2,x=-1;f==="RGBA"?(b=0,w=y,E=y*2,x=y*3):f==="RGB"?(b=0,w=y,E=y*2):f==="RBG"&&(b=0,E=y,w=y*2);for(let I=0;I<d;I++)for(let L=0;L<a;L++){let _=(o.data[b++]-l[0])*h[0],M=(o.data[w++]-l[1])*h[1],j=(o.data[E++]-l[2])*h[2],z=x===-1?255:(o.data[x++]-l[3])*h[3];u.fillStyle="rgba("+_+","+M+","+j+","+z+")",u.fillRect(L,I,1,1)}return n.toDataURL()}else throw new Error("Can not access image data")},ir=(o,r)=>{let n=document.createElement("canvas").getContext("2d"),u;if(n!=null){let a,d,f;r?.tensorLayout!==void 0&&r.tensorLayout==="NHWC"?(a=o.dims[2],d=o.dims[1],f=o.dims[3]):(a=o.dims[3],d=o.dims[2],f=o.dims[1]);let m=r!==void 0&&r.format!==void 0?r.format:"RGB",h=r?.norm,l,y;h===void 0||h.mean===void 0?l=[255,255,255,255]:typeof h.mean=="number"?l=[h.mean,h.mean,h.mean,h.mean]:(l=[h.mean[0],h.mean[1],h.mean[2],255],h.mean[3]!==void 0&&(l[3]=h.mean[3])),h===void 0||h.bias===void 0?y=[0,0,0,0]:typeof h.bias=="number"?y=[h.bias,h.bias,h.bias,h.bias]:(y=[h.bias[0],h.bias[1],h.bias[2],0],h.bias[3]!==void 0&&(y[3]=h.bias[3]));let b=d*a;if(r!==void 0&&(r.format!==void 0&&f===4&&r.format!=="RGBA"||f===3&&r.format!=="RGB"&&r.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let w=4,E=0,x=1,I=2,L=3,_=0,M=b,j=b*2,z=-1;m==="RGBA"?(_=0,M=b,j=b*2,z=b*3):m==="RGB"?(_=0,M=b,j=b*2):m==="RBG"&&(_=0,j=b,M=b*2),u=n.createImageData(a,d);for(let R=0;R<d*a;E+=w,x+=w,I+=w,L+=w,R++)u.data[E]=(o.data[_++]-y[0])*l[0],u.data[x]=(o.data[M++]-y[1])*l[1],u.data[I]=(o.data[j++]-y[2])*l[2],u.data[L]=z===-1?255:(o.data[z++]-y[3])*l[3]}else throw new Error("Can not access image data");return u}});var yt,sr,ur,fr,cr,lr=U(()=>{"use strict";Ke();yt=(o,r)=>{if(o===void 0)throw new Error("Image buffer must be defined");if(r.height===void 0||r.width===void 0)throw new Error("Image height and width must be defined");if(r.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:u}=r,a=r.norm??{mean:255,bias:0},d,f;typeof a.mean=="number"?d=[a.mean,a.mean,a.mean,a.mean]:d=[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],typeof a.bias=="number"?f=[a.bias,a.bias,a.bias,a.bias]:f=[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let m=r.format!==void 0?r.format:"RGBA",h=r.tensorFormat!==void 0&&r.tensorFormat!==void 0?r.tensorFormat:"RGB",l=n*u,y=h==="RGBA"?new Float32Array(l*4):new Float32Array(l*3),b=4,w=0,E=1,x=2,I=3,L=0,_=l,M=l*2,j=-1;m==="RGB"&&(b=3,w=0,E=1,x=2,I=-1),h==="RGBA"?j=l*3:h==="RBG"?(L=0,M=l,_=l*2):h==="BGR"&&(M=0,_=l,L=l*2);for(let R=0;R<l;R++,w+=b,x+=b,E+=b,I+=b)y[L++]=(o[w]+f[0])/d[0],y[_++]=(o[E]+f[1])/d[1],y[M++]=(o[x]+f[2])/d[2],j!==-1&&I!==-1&&(y[j++]=(o[I]+f[3])/d[3]);return h==="RGBA"?new J("float32",y,[1,4,n,u]):new J("float32",y,[1,3,n,u])},sr=async(o,r)=>{let n=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=typeof ImageData<"u"&&o instanceof ImageData,a=typeof ImageBitmap<"u"&&o instanceof ImageBitmap,d=typeof o=="string",f,m=r??{};if(n){let h=document.createElement("canvas");h.width=o.width,h.height=o.height;let l=h.getContext("2d");if(l!=null){let y=o.height,b=o.width;if(r!==void 0&&r.resizedHeight!==void 0&&r.resizedWidth!==void 0&&(y=r.resizedHeight,b=r.resizedWidth),r!==void 0){if(m=r,r.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");m.tensorFormat="RGBA",m.height=y,m.width=b}else m.tensorFormat="RGBA",m.height=y,m.width=b;l.drawImage(o,0,0),f=l.getImageData(0,0,b,y).data}else throw new Error("Can not access image data")}else if(u){let h,l;if(r!==void 0&&r.resizedWidth!==void 0&&r.resizedHeight!==void 0?(h=r.resizedHeight,l=r.resizedWidth):(h=o.height,l=o.width),r!==void 0&&(m=r),m.format="RGBA",m.height=h,m.width=l,r!==void 0){let y=document.createElement("canvas");y.width=l,y.height=h;let b=y.getContext("2d");if(b!=null)b.putImageData(o,0,0),f=b.getImageData(0,0,l,h).data;else throw new Error("Can not access image data")}else f=o.data}else if(a){if(r===void 0)throw new Error("Please provide image config with format for Imagebitmap");let h=document.createElement("canvas");h.width=o.width,h.height=o.height;let l=h.getContext("2d");if(l!=null){let y=o.height,b=o.width;return l.drawImage(o,0,0,b,y),f=l.getImageData(0,0,b,y).data,m.height=y,m.width=b,yt(f,m)}else throw new Error("Can not access image data")}else{if(d)return new Promise((h,l)=>{let y=document.createElement("canvas"),b=y.getContext("2d");if(!o||!b)return l();let w=new Image;w.crossOrigin="Anonymous",w.src=o,w.onload=()=>{y.width=w.width,y.height=w.height,b.drawImage(w,0,0,y.width,y.height);let E=b.getImageData(0,0,y.width,y.height);m.height=y.height,m.width=y.width,h(yt(E.data,m))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(f!==void 0)return yt(f,m);throw new Error("Input data provided is not supported - aborted tensor creation")},ur=(o,r)=>{let{width:n,height:u,download:a,dispose:d}=r,f=[1,u,n,4];return new J({location:"texture",type:"float32",texture:o,dims:f,download:a,dispose:d})},fr=(o,r)=>{let{dataType:n,dims:u,download:a,dispose:d}=r;return new J({location:"gpu-buffer",type:n??"float32",gpuBuffer:o,dims:u,download:a,dispose:d})},cr=(o,r,n)=>new J({location:"cpu-pinned",type:o,data:r,dims:n??[r.length]})});var Be,Qe,dr,pr,mr=U(()=>{"use strict";Be=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Qe=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),dr=!1,pr=()=>{if(!dr){dr=!0;let o=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",r=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";o&&(Be.set("int64",BigInt64Array),Qe.set(BigInt64Array,"int64")),r&&(Be.set("uint64",BigUint64Array),Qe.set(BigUint64Array,"uint64"))}}});var hr,yr,gr=U(()=>{"use strict";Ke();hr=o=>{let r=1;for(let n=0;n<o.length;n++){let u=o[n];if(typeof u!="number"||!Number.isSafeInteger(u))throw new TypeError(`dims[${n}] must be an integer, got: ${u}`);if(u<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${u}`);r*=u}return r},yr=(o,r)=>{switch(o.location){case"cpu":return new J(o.type,o.data,r);case"cpu-pinned":return new J({location:"cpu-pinned",data:o.data,type:o.type,dims:r});case"texture":return new J({location:"texture",texture:o.texture,type:o.type,dims:r});case"gpu-buffer":return new J({location:"gpu-buffer",gpuBuffer:o.gpuBuffer,type:o.type,dims:r});default:throw new Error(`tensorReshape: tensor location ${o.location} is not supported`)}}});var J,Ke=U(()=>{"use strict";ar();lr();mr();gr();J=class{constructor(r,n,u){pr();let a,d;if(typeof r=="object"&&"location"in r)switch(this.dataLocation=r.location,a=r.type,d=r.dims,r.location){case"cpu-pinned":{let m=Be.get(a);if(!m)throw new TypeError(`unsupported type "${a}" to create tensor from pinned buffer`);if(!(r.data instanceof m))throw new TypeError(`buffer should be of type ${m.name}`);this.cpuData=r.data;break}case"texture":{if(a!=="float32")throw new TypeError(`unsupported type "${a}" to create tensor from texture`);this.gpuTextureData=r.texture,this.downloader=r.download,this.disposer=r.dispose;break}case"gpu-buffer":{if(a!=="float32"&&a!=="float16"&&a!=="int32"&&a!=="int64"&&a!=="uint32"&&a!=="bool")throw new TypeError(`unsupported type "${a}" to create tensor from gpu buffer`);this.gpuBufferData=r.gpuBuffer,this.downloader=r.download,this.disposer=r.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let m,h;if(typeof r=="string")if(a=r,h=u,r==="string"){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");m=n}else{let l=Be.get(r);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${r}.`);if(Array.isArray(n)){if(r==="float16")throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");r==="uint64"||r==="int64"?m=l.from(n,BigInt):m=l.from(n)}else if(n instanceof l)m=n;else throw new TypeError(`A ${a} tensor's data must be type of ${l}`)}else if(h=n,Array.isArray(r)){if(r.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof r[0];if(l==="string")a="string",m=r;else if(l==="boolean")a="bool",m=Uint8Array.from(r);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else{let l=Qe.get(r.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${r.constructor}.`);a=l,m=r}if(h===void 0)h=[m.length];else if(!Array.isArray(h))throw new TypeError("A tensor's dims must be a number array");d=h,this.cpuData=m,this.dataLocation="cpu"}let f=hr(d);if(this.cpuData&&f!==this.cpuData.length)throw new Error(`Tensor's size(${f}) does not match data length(${this.cpuData.length}).`);this.type=a,this.dims=d,this.size=f}static async fromImage(r,n){return sr(r,n)}static fromTexture(r,n){return ur(r,n)}static fromGpuBuffer(r,n){return fr(r,n)}static fromPinnedBuffer(r,n,u){return cr(r,n,u)}toDataURL(r){return or(this,r)}toImageData(r){return ir(this,r)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(r){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let n=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,r&&this.disposer&&(this.disposer(),this.disposer=void 0),n}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(r){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return yr(this,r)}}});var V,et=U(()=>{"use strict";Ke();V=J});var wr,br,be,ve,gt=U(()=>{"use strict";ht();wr=(o,r)=>{we.wasm.trace&&console.timeStamp(`${o}::ORT::${r}`)},br=(o,r)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],u=!1;for(let a=0;a<n.length;a++){if(u&&!n[a].includes("TRACE_FUNC")){let d=`FUNC_${o}::${n[a].trim().split(" ")[1]}`;r&&(d+=`::${r}`),wr("CPU",d);return}n[a].includes("TRACE_FUNC")&&(u=!0)}},be=o=>{we.wasm.trace&&br("BEGIN",o)},ve=o=>{we.wasm.trace&&br("END",o)}});var tt,vr=U(()=>{"use strict";Ze();et();gt();tt=class o{constructor(r){this.handler=r}async run(r,n,u){be();let a={},d={};if(typeof r!="object"||r===null||r instanceof V||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let f=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof V)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");f=!1;for(let l of n){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);a[l]=null}if(typeof u=="object"&&u!==null)d=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,y=Object.getOwnPropertyNames(n);for(let b of this.outputNames)if(y.indexOf(b)!==-1){let w=n[b];(w===null||w instanceof V)&&(l=!0,f=!1,a[b]=w)}if(l){if(typeof u=="object"&&u!==null)d=u;else if(typeof u<"u")throw new TypeError("'options' must be an object.")}else d=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of this.inputNames)if(typeof r[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(f)for(let l of this.outputNames)a[l]=null;let m=await this.handler.run(r,a,d),h={};for(let l in m)if(Object.hasOwnProperty.call(m,l)){let y=m[l];y instanceof V?h[l]=y:h[l]=new V(y.type,y.data,y.dims)}return ve(),h}async release(){return this.handler.dispose()}static async create(r,n,u,a){be();let d,f={};if(typeof r=="string"){if(d=r,typeof n=="object"&&n!==null)f=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof Uint8Array){if(d=r,typeof n=="object"&&n!==null)f=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer){let b=r,w=0,E=r.byteLength;if(typeof n=="object"&&n!==null)f=n;else if(typeof n=="number"){if(w=n,!Number.isSafeInteger(w))throw new RangeError("'byteOffset' must be an integer.");if(w<0||w>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(E=r.byteLength-w,typeof u=="number"){if(E=u,!Number.isSafeInteger(E))throw new RangeError("'byteLength' must be an integer.");if(E<=0||w+E>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-w}].`);if(typeof a=="object"&&a!==null)f=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(typeof u<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");d=new Uint8Array(b,w,E)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let h=(f.executionProviders||[]).map(b=>typeof b=="string"?b:b.name),y=await(await Je(h)).createInferenceSessionHandler(d,f);return ve(),new o(y)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}});var Fn,Er=U(()=>{"use strict";vr();Fn=tt});var Tr=U(()=>{"use strict"});var Wn,rt,Sr=U(()=>{"use strict";Ze();et();Wn="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",rt=class o{constructor(r,n,u){this.handler=r,this.hasOptimizerModel=n,this.hasEvalModel=u}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(r,n){let u=r.evalModel||"",a=r.optimizerModel||"",d=n||{},m=(d.executionProviders||[]).map(l=>typeof l=="string"?l:l.name),h=await Je(m);if(h.createTrainingSessionHandler){let l=await h.createTrainingSessionHandler(r.checkpointState,r.trainModel,u,a,d);return new o(l,!!r.optimizerModel,!!r.evalModel)}else throw new Error(Wn)}typeNarrowingForRunStep(r,n,u,a,d){let f={},m={};if(typeof u!="object"||u===null||u instanceof V||Array.isArray(u))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let h=!0;if(typeof a=="object"){if(a===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(a instanceof V)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(a)){if(a.length===0)throw new TypeError("'fetches' cannot be an empty array.");h=!1;for(let l of a){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(n.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);f[l]=null}if(typeof d=="object"&&d!==null)m=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,y=Object.getOwnPropertyNames(a);for(let b of n)if(y.indexOf(b)!==-1){let w=a[b];(w===null||w instanceof V)&&(l=!0,h=!1,f[b]=w)}if(l){if(typeof d=="object"&&d!==null)m=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else m=a}}else if(typeof a<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of r)if(typeof u[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(h)for(let l of n)f[l]=null;return[f,m]}convertHandlerReturnTypeToMapOfTensors(r){let n={};for(let u in r)if(Object.hasOwnProperty.call(r,u)){let a=r[u];a instanceof V?n[u]=a:n[u]=new V(a.type,a.data,a.dims)}return n}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(r,n,u){let[a,d]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,r,n,u),f=await this.handler.runTrainStep(r,a,d);return this.convertHandlerReturnTypeToMapOfTensors(f)}async runOptimizerStep(r){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(r||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(r,n,u){if(this.hasEvalModel){let[a,d]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,r,n,u),f=await this.handler.runEvalStep(r,a,d);return this.convertHandlerReturnTypeToMapOfTensors(f)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(r=!0){return this.handler.getParametersSize(r)}async loadParametersBuffer(r,n=!0){let u=await this.getParametersSize(n);if(r.length!==4*u)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(r,n)}async getContiguousParameters(r=!0){return this.handler.getContiguousParameters(r)}async release(){return this.handler.dispose()}}});var kn,Ar=U(()=>{"use strict";Sr();kn=rt});var wt={};qe(wt,{InferenceSession:()=>Fn,TRACE:()=>wr,TRACE_FUNC_BEGIN:()=>be,TRACE_FUNC_END:()=>ve,Tensor:()=>V,TrainingSession:()=>kn,env:()=>N,registerBackend:()=>Ae});var Ee=U(()=>{"use strict";Qt();nr();Er();et();gt();Tr();Ar()});var Pr={};qe(Pr,{readFile:()=>Nn});var Nn,Ir=U(()=>{Nn=void 0});var xr={};qe(xr,{join:()=>$n});var $n,_r=U(()=>{$n=void 0});var Dr=Mn((Cr,bt)=>{"use strict";var Br=(()=>{var o=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(o=o||__filename),function(r={}){var n=r,u,a;n.ready=new Promise((e,t)=>{u=e,a=t});var d=Object.assign({},n),f="./this.program",m=typeof window=="object",h=typeof importScripts=="function",l=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",y="",b,w,E;if(l){var x=(Ir(),mt(Pr)),I=(_r(),mt(xr));y=h?I.dirname(y)+"/":__dirname+"/",b=(e,t)=>(e=e.startsWith("file://")?new URL(e):I.normalize(e),x.readFileSync(e,t?void 0:"utf8")),E=e=>(e=b(e,!0),e.buffer||(e=new Uint8Array(e)),e),w=(e,t,i,s=!0)=>{e=e.startsWith("file://")?new URL(e):I.normalize(e),x.readFile(e,s?void 0:"utf8",(c,g)=>{c?i(c):t(s?g.buffer:g)})},!n.thisProgram&&1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),n.inspect=()=>"[Emscripten Module object]"}else(m||h)&&(h?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),o&&(y=o),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",b=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},h&&(E=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),w=(e,t,i)=>{var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=()=>{s.status==200||s.status==0&&s.response?t(s.response):i()},s.onerror=i,s.send(null)});var L=console.log.bind(console),_=console.error.bind(console);Object.assign(n,d),d=null,typeof WebAssembly!="object"&&Me("no native wasm support detected");var M,j=!1,z,R,oe,pe,T,B,Ue,Le,Pe,ue;function C(){var e=M.buffer;n.HEAP8=z=new Int8Array(e),n.HEAP16=oe=new Int16Array(e),n.HEAPU8=R=new Uint8Array(e),n.HEAPU16=pe=new Uint16Array(e),n.HEAP32=T=new Int32Array(e),n.HEAPU32=B=new Uint32Array(e),n.HEAPF32=Ue=new Float32Array(e),n.HEAPF64=ue=new Float64Array(e),n.HEAP64=Le=new BigInt64Array(e),n.HEAPU64=Pe=new BigUint64Array(e)}var fe=[],Te=[],re=[],ne=0,G=null,q=null;function Me(e){throw e="Aborted("+e+")",_(e),j=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),a(e),e}function me(e){return e.startsWith("data:application/octet-stream;base64,")}var ce;if(ce="ort-wasm.wasm",!me(ce)){var Ie=ce;ce=n.locateFile?n.locateFile(Ie,y):y+Ie}function Re(e){if(E)return E(e);throw"both async and sync fetching of the wasm failed"}function he(e){if(m||h){if(typeof fetch=="function"&&!e.startsWith("file://"))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>Re(e));if(w)return new Promise((t,i)=>{w(e,s=>t(new Uint8Array(s)),i)})}return Promise.resolve().then(()=>Re(e))}function le(e,t,i){return he(e).then(s=>WebAssembly.instantiate(s,t)).then(s=>s).then(i,s=>{_(`failed to asynchronously prepare wasm: ${s}`),Me(s)})}function Fe(e,t){var i=ce;return typeof WebAssembly.instantiateStreaming!="function"||me(i)||i.startsWith("file://")||l||typeof fetch!="function"?le(i,e,t):fetch(i,{credentials:"same-origin"}).then(s=>WebAssembly.instantiateStreaming(s,e).then(t,function(c){return _(`wasm streaming compile failed: ${c}`),_("falling back to ArrayBuffer instantiation"),le(i,e,t)}))}function X(e){this.Va=e-24,this.fb=function(t){B[this.Va+4>>>2>>>0]=t},this.eb=function(t){B[this.Va+8>>>2>>>0]=t},this.Za=function(t,i){this.$a(),this.fb(t),this.eb(i)},this.$a=function(){B[this.Va+16>>>2>>>0]=0}}var Y=0,xe=0,_e=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,We=(e,t,i)=>{t>>>=0;var s=t+i;for(i=t;e[i]&&!(i>=s);)++i;if(16<i-t&&e.buffer&&_e)return _e.decode(e.subarray(t,i));for(s="";t<i;){var c=e[t++];if(c&128){var g=e[t++]&63;if((c&224)==192)s+=String.fromCharCode((c&31)<<6|g);else{var S=e[t++]&63;c=(c&240)==224?(c&15)<<12|g<<6|S:(c&7)<<18|g<<12|S<<6|e[t++]&63,65536>c?s+=String.fromCharCode(c):(c-=65536,s+=String.fromCharCode(55296|c>>10,56320|c&1023))}}else s+=String.fromCharCode(c)}return s},ke=(e,t)=>(e>>>=0)?We(R,e,t):"",Ne=e=>{for(var t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);127>=s?t++:2047>=s?t+=2:55296<=s&&57343>=s?(t+=4,++i):t+=3}return t},$e=(e,t,i,s)=>{if(i>>>=0,!(0<s))return 0;var c=i;s=i+s-1;for(var g=0;g<e.length;++g){var S=e.charCodeAt(g);if(55296<=S&&57343>=S){var v=e.charCodeAt(++g);S=65536+((S&1023)<<10)|v&1023}if(127>=S){if(i>=s)break;t[i++>>>0]=S}else{if(2047>=S){if(i+1>=s)break;t[i++>>>0]=192|S>>6}else{if(65535>=S){if(i+2>=s)break;t[i++>>>0]=224|S>>12}else{if(i+3>=s)break;t[i++>>>0]=240|S>>18,t[i++>>>0]=128|S>>12&63}t[i++>>>0]=128|S>>6&63}t[i++>>>0]=128|S&63}}return t[i>>>0]=0,i-c},_t=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},Bt,te=e=>{for(var t="";R[e>>>0];)t+=Bt[R[e++>>>0]];return t},ut={},ft={},dn={},de;function pn(e,t,i={}){var s=t.name;if(!e)throw new de(`type "${s}" must have a positive integer typeid pointer`);if(ft.hasOwnProperty(e)){if(i.gb)return;throw new de(`Cannot register type '${s}' twice`)}ft[e]=t,delete dn[e],ut.hasOwnProperty(e)&&(t=ut[e],delete ut[e],t.forEach(c=>c()))}function ie(e,t,i={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");pn(e,t,i)}var Ct=(e,t,i)=>{switch(t){case 1:return i?s=>z[s>>>0>>>0]:s=>R[s>>>0>>>0];case 2:return i?s=>oe[s>>>1>>>0]:s=>pe[s>>>1>>>0];case 4:return i?s=>T[s>>>2>>>0]:s=>B[s>>>2>>>0];case 8:return i?s=>Le[s>>>3]:s=>Pe[s>>>3];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}};function Dt(){this.Sa=[void 0],this.bb=[]}var Q=new Dt;function ct(e){e>>>=0,e>=Q.Va&&--Q.get(e).cb===0&&Q.$a(e)}var Z=e=>{if(!e)throw new de("Cannot use deleted val. handle = "+e);return Q.get(e).value},ee=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Q.Za({cb:1,value:e})}};function Ut(e){return this.fromWireType(T[e>>>2>>>0])}var mn=(e,t)=>{switch(t){case 4:return function(i){return this.fromWireType(Ue[i>>>2>>>0])};case 8:return function(i){return this.fromWireType(ue[i>>>3>>>0])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}};function hn(e){return this.fromWireType(B[e>>>2>>>0])}var Lt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,yn=(e,t)=>{for(var i=e>>1,s=i+t/2;!(i>=s)&&pe[i>>>0];)++i;if(i<<=1,32<i-e&&Lt)return Lt.decode(R.subarray(e>>>0,i>>>0));for(i="",s=0;!(s>=t/2);++s){var c=oe[e+2*s>>>1>>>0];if(c==0)break;i+=String.fromCharCode(c)}return i},gn=(e,t,i)=>{if(i===void 0&&(i=2147483647),2>i)return 0;i-=2;var s=t;i=i<2*e.length?i/2:e.length;for(var c=0;c<i;++c)oe[t>>>1>>>0]=e.charCodeAt(c),t+=2;return oe[t>>>1>>>0]=0,t-s},wn=e=>2*e.length,bn=(e,t)=>{for(var i=0,s="";!(i>=t/4);){var c=T[e+4*i>>>2>>>0];if(c==0)break;++i,65536<=c?(c-=65536,s+=String.fromCharCode(55296|c>>10,56320|c&1023)):s+=String.fromCharCode(c)}return s},vn=(e,t,i)=>{if(t>>>=0,i===void 0&&(i=2147483647),4>i)return 0;var s=t;i=s+i-4;for(var c=0;c<e.length;++c){var g=e.charCodeAt(c);if(55296<=g&&57343>=g){var S=e.charCodeAt(++c);g=65536+((g&1023)<<10)|S&1023}if(T[t>>>2>>>0]=g,t+=4,t+4>i)break}return T[t>>>2>>>0]=0,t-s},En=e=>{for(var t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);55296<=s&&57343>=s&&++i,t+=4}return t},He=(e,t)=>{var i=ft[e];if(i===void 0)throw e=Vt(e),i=te(e),ae(e),new de(t+" has unknown type "+i);return i},Tn={},je=e=>{var t=Tn[e];return t===void 0?te(e):t},ze=[],Mt=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Sn=e=>{var t=ze.length;return ze.push(e),t},An=(e,t)=>{for(var i=Array(e),s=0;s<e;++s)i[s]=He(B[t+4*s>>>2>>>0],"parameter "+s);return i},Rt=e=>{if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return 48<=t&&57>=t?`_${e}`:e},Ft={};function On(e,t){return e=Rt(e),{[e]:function(){return t.apply(this,arguments)}}[e]}function Pn(e){var t=Function;if(!(t instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof t} which is not a function`);var i=On(t.name||"unknownFunctionName",function(){});return i.prototype=t.prototype,i=new i,e=t.apply(i,e),e instanceof Object?e:i}var In=e=>{for(var t="",i=0;i<e;++i)t+=(i!==0?", ":"")+"arg"+i;var s="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`;for(i=0;i<e;++i)s+="var argType"+i+" = requireRegisteredType(HEAPU32[((argTypes)>>>2)], 'parameter "+i+`');
var arg`+i+" = argType"+i+`.readValueFromPointer(args);
args += argType`+i+`['argPackAdvance'];
argTypes += 4;
`;return new Function("requireRegisteredType","Module","valueToHandle","getMemory",s+("var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`))(He,n,ee,()=>B)},Wt={},Se=e=>e%4===0&&(e%100!==0||e%400===0),kt=[0,31,60,91,121,152,182,213,244,274,305,335],Nt=[0,31,59,90,120,151,181,212,243,273,304,334],$t=e=>{var t=Ne(e)+1,i=Ye(t);return i&&$e(e,R,i,t),i},lt={},Ht=()=>{if(!dt){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"},t;for(t in lt)lt[t]===void 0?delete e[t]:e[t]=lt[t];var i=[];for(t in e)i.push(`${t}=${e[t]}`);dt=i}return dt},dt,xn=[null,[],[]],jt=[31,29,31,30,31,30,31,31,30,31,30,31],zt=[31,28,31,30,31,30,31,31,30,31,30,31];function _n(e){var t=Array(Ne(e)+1);return $e(e,t,0,t.length),t}function Gt(e,t,i,s){function c(p,D,W){for(p=typeof p=="number"?p.toString():p||"";p.length<D;)p=W[0]+p;return p}function g(p,D){return c(p,D,"0")}function S(p,D){function W(Kt){return 0>Kt?-1:0<Kt?1:0}var ye;return(ye=W(p.getFullYear()-D.getFullYear()))===0&&(ye=W(p.getMonth()-D.getMonth()))===0&&(ye=W(p.getDate()-D.getDate())),ye}function v(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function A(p){var D=p.Ta;for(p=new Date(new Date(p.Ua+1900,0,1).getTime());0<D;){var W=p.getMonth(),ye=(Se(p.getFullYear())?jt:zt)[W];if(D>ye-p.getDate())D-=ye-p.getDate()+1,p.setDate(1),11>W?p.setMonth(W+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+D);break}}return W=new Date(p.getFullYear()+1,0,4),D=v(new Date(p.getFullYear(),0,4)),W=v(W),0>=S(D,p)?0>=S(W,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}e>>>=0,t>>>=0,i>>>=0,s>>>=0;var P=B[s+40>>>2>>>0];s={kb:T[s>>>2>>>0],jb:T[s+4>>>2>>>0],Xa:T[s+8>>>2>>>0],ab:T[s+12>>>2>>>0],Ya:T[s+16>>>2>>>0],Ua:T[s+20>>>2>>>0],Oa:T[s+24>>>2>>>0],Ta:T[s+28>>>2>>>0],mb:T[s+32>>>2>>>0],ib:T[s+36>>>2>>>0],lb:P?ke(P):""},i=ke(i),P={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var F in P)i=i.replace(new RegExp(F,"g"),P[F]);var K="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),se="January February March April May June July August September October November December".split(" ");P={"%a":p=>K[p.Oa].substring(0,3),"%A":p=>K[p.Oa],"%b":p=>se[p.Ya].substring(0,3),"%B":p=>se[p.Ya],"%C":p=>g((p.Ua+1900)/100|0,2),"%d":p=>g(p.ab,2),"%e":p=>c(p.ab,2," "),"%g":p=>A(p).toString().substring(2),"%G":p=>A(p),"%H":p=>g(p.Xa,2),"%I":p=>(p=p.Xa,p==0?p=12:12<p&&(p-=12),g(p,2)),"%j":p=>{for(var D=0,W=0;W<=p.Ya-1;D+=(Se(p.Ua+1900)?jt:zt)[W++]);return g(p.ab+D,3)},"%m":p=>g(p.Ya+1,2),"%M":p=>g(p.jb,2),"%n":()=>`
`,"%p":p=>0<=p.Xa&&12>p.Xa?"AM":"PM","%S":p=>g(p.kb,2),"%t":()=>"	","%u":p=>p.Oa||7,"%U":p=>g(Math.floor((p.Ta+7-p.Oa)/7),2),"%V":p=>{var D=Math.floor((p.Ta+7-(p.Oa+6)%7)/7);if(2>=(p.Oa+371-p.Ta-2)%7&&D++,D)D==53&&(W=(p.Oa+371-p.Ta)%7,W==4||W==3&&Se(p.Ua)||(D=1));else{D=52;var W=(p.Oa+7-p.Ta-1)%7;(W==4||W==5&&Se(p.Ua%400-1))&&D++}return g(D,2)},"%w":p=>p.Oa,"%W":p=>g(Math.floor((p.Ta+7-(p.Oa+6)%7)/7),2),"%y":p=>(p.Ua+1900).toString().substring(2),"%Y":p=>p.Ua+1900,"%z":p=>{p=p.ib;var D=0<=p;return p=Math.abs(p)/60,(D?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.lb,"%%":()=>"%"},i=i.replace(/%%/g,"\0\0");for(F in P)i.includes(F)&&(i=i.replace(new RegExp(F,"g"),P[F](s)));return i=i.replace(/\0\0/g,"%"),F=_n(i),F.length>t?0:(z.set(F,e>>>0),F.length-1)}for(var Yt=Array(256),Ge=0;256>Ge;++Ge)Yt[Ge]=String.fromCharCode(Ge);Bt=Yt,de=n.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},n.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},Object.assign(Dt.prototype,{get(e){return this.Sa[e]},has(e){return this.Sa[e]!==void 0},Za(e){var t=this.bb.pop()||this.Sa.length;return this.Sa[t]=e,t},$a(e){this.Sa[e]=void 0,this.bb.push(e)}}),Q.Sa.push({value:void 0},{value:null},{value:!0},{value:!1}),Q.Va=Q.Sa.length,n.count_emval_handles=()=>{for(var e=0,t=Q.Va;t<Q.Sa.length;++t)Q.Sa[t]!==void 0&&++e;return e};var Bn={a:function(e,t,i){throw e>>>=0,new X(e).Za(t>>>0,i>>>0),Y=e,xe++,Y},v:function(){return 0},ba:function(){},N:function(){},P:function(){},H:function(){return 0},$:function(){},V:function(){},_:function(){},B:function(){},O:function(){},L:function(){},aa:function(){},M:function(){},E:function(e,t,i,s,c){t>>>=0,t=te(t);var g=t.indexOf("u")!=-1;g&&(c=(1n<<64n)-1n),ie(e>>>0,{name:t,fromWireType:S=>S,toWireType:function(S,v){if(typeof v!="bigint"&&typeof v!="number")throw new TypeError(`Cannot convert "${_t(v)}" to ${this.name}`);if(v<s||v>c)throw new TypeError(`Passing a number "${_t(v)}" from JS side to C/C++ side to an argument of type "${t}", which is outside the valid range [${s}, ${c}]!`);return v},argPackAdvance:8,readValueFromPointer:Ct(t,i>>>0,!g),Wa:null})},ea:function(e,t,i,s){t=te(t>>>0),ie(e>>>0,{name:t,fromWireType:function(c){return!!c},toWireType:function(c,g){return g?i:s},argPackAdvance:8,readValueFromPointer:function(c){return this.fromWireType(R[c>>>0])},Wa:null})},da:function(e,t){t=te(t>>>0),ie(e>>>0,{name:t,fromWireType:i=>{var s=Z(i);return ct(i),s},toWireType:(i,s)=>ee(s),argPackAdvance:8,readValueFromPointer:Ut,Wa:null})},D:function(e,t,i){t=te(t>>>0),ie(e>>>0,{name:t,fromWireType:s=>s,toWireType:(s,c)=>c,argPackAdvance:8,readValueFromPointer:mn(t,i>>>0),Wa:null})},p:function(e,t,i,s,c){if(e>>>=0,i>>>=0,t=te(t>>>0),c===-1&&(c=4294967295),c=v=>v,s===0){var g=32-8*i;c=v=>v<<g>>>g}var S=t.includes("unsigned")?function(v,A){return A>>>0}:function(v,A){return A};ie(e,{name:t,fromWireType:c,toWireType:S,argPackAdvance:8,readValueFromPointer:Ct(t,i,s!==0),Wa:null})},l:function(e,t,i){function s(g){return new c(z.buffer,B[g+4>>>2>>>0],B[g>>>2>>>0])}var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];i=te(i>>>0),ie(e>>>0,{name:i,fromWireType:s,argPackAdvance:8,readValueFromPointer:s},{gb:!0})},F:function(e,t){t=te(t>>>0);var i=t==="std::string";ie(e>>>0,{name:t,fromWireType:function(s){var c=B[s>>>2>>>0],g=s+4;if(i)for(var S=g,v=0;v<=c;++v){var A=g+v;if(v==c||R[A>>>0]==0){if(S=ke(S,A-S),P===void 0)var P=S;else P+=String.fromCharCode(0),P+=S;S=A+1}}else{for(P=Array(c),v=0;v<c;++v)P[v]=String.fromCharCode(R[g+v>>>0]);P=P.join("")}return ae(s),P},toWireType:function(s,c){c instanceof ArrayBuffer&&(c=new Uint8Array(c));var g=typeof c=="string";if(!(g||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int8Array))throw new de("Cannot pass non-string to std::string");var S=i&&g?Ne(c):c.length,v=Ye(4+S+1),A=v+4;if(B[v>>>2>>>0]=S,i&&g)$e(c,R,A,S+1);else if(g)for(g=0;g<S;++g){var P=c.charCodeAt(g);if(255<P)throw ae(A),new de("String has UTF-16 code units that do not fit in 8 bits");R[A+g>>>0]=P}else for(g=0;g<S;++g)R[A+g>>>0]=c[g];return s!==null&&s.push(ae,v),v},argPackAdvance:8,readValueFromPointer:hn,Wa(s){ae(s)}})},x:function(e,t,i){if(t>>>=0,i>>>=0,i=te(i),t===2)var s=yn,c=gn,g=wn,S=()=>pe,v=1;else t===4&&(s=bn,c=vn,g=En,S=()=>B,v=2);ie(e>>>0,{name:i,fromWireType:A=>{for(var P=B[A>>>2>>>0],F=S(),K,se=A+4,p=0;p<=P;++p){var D=A+4+p*t;(p==P||F[D>>>v]==0)&&(se=s(se,D-se),K===void 0?K=se:(K+=String.fromCharCode(0),K+=se),se=D+t)}return ae(A),K},toWireType:(A,P)=>{if(typeof P!="string")throw new de(`Cannot pass non-string to C++ string type ${i}`);var F=g(P),K=Ye(4+F+t);return B[K>>>2]=F>>v,c(P,K+4,F+t),A!==null&&A.push(ae,K),K},argPackAdvance:8,readValueFromPointer:Ut,Wa(A){ae(A)}})},fa:function(e,t){t=te(t>>>0),ie(e>>>0,{hb:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ca:()=>!0,o:function(e,t,i){t>>>=0,i>>>=0,e=Z(e>>>0),t=He(t,"emval::as");var s=[],c=ee(s);return B[i>>>2>>>0]=c,t.toWireType(s,e)},h:function(e,t,i,s,c){i>>>=0,s>>>=0,c>>>=0,e=ze[e>>>0],t=Z(t>>>0),i=je(i);var g=[];return B[s>>>2>>>0]=ee(g),e(t,i,g,c)},r:function(e,t,i,s){i>>>=0,s>>>=0,e=ze[e>>>0],t=Z(t>>>0),i=je(i),e(t,i,null,s)},b:ct,y:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),e==t},u:function(e){return e>>>=0,e===0?ee(Mt()):(e=je(e),ee(Mt()[e]))},g:function(e,t){var i=An(e,t>>>0),s=i[0];t=s.name+"_$"+i.slice(1).map(function(F){return F.name}).join("_")+"$";var c=Ft[t];if(c!==void 0)return c;c=["retType"];for(var g=[s],S="",v=0;v<e-1;++v)S+=(v!==0?", ":"")+"arg"+v,c.push("argType"+v),g.push(i[1+v]);var A="return function "+Rt("methodCaller_"+t)+`(handle, name, destructors, args) {
`,P=0;for(v=0;v<e-1;++v)A+="    var arg"+v+" = argType"+v+".readValueFromPointer(args"+(P?"+"+P:"")+`);
`,P+=i[v+1].argPackAdvance;for(A+="    var rv = handle[name]("+S+`);
`,v=0;v<e-1;++v)i[v+1].deleteObject&&(A+="    argType"+v+".deleteObject(arg"+v+`);
`);return s.hb||(A+=`    return retType.toWireType(destructors, rv);
`),c.push(A+`};
`),e=Pn(c).apply(null,g),c=Sn(e),Ft[t]=c},q:function(e,t){return t>>>=0,e=Z(e>>>0),t=Z(t),ee(e[t])},c:function(e){e>>>=0,4<e&&(Q.get(e).cb+=1)},G:function(e,t,i,s){i>>>=0,s>>>=0,e=Z(e>>>0);var c=Wt[t];return c||(c=In(t),Wt[t]=c),c(e,i,s)},s:function(){return ee([])},k:function(e){e=Z(e>>>0);for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return ee(t)},d:function(e){return ee(je(e>>>0))},j:function(){return ee({})},e:function(e){e>>>=0;for(var t=Z(e);t.length;){var i=t.pop();t.pop()(i)}ct(e)},i:function(e,t,i){t>>>=0,i>>>=0,e=Z(e>>>0),t=Z(t),i=Z(i),e[t]=i},f:function(e,t){return t>>>=0,e=He(e>>>0,"_emval_take_value"),e=e.readValueFromPointer(t),ee(e)},S:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),T[t>>>2>>>0]=e.getUTCSeconds(),T[t+4>>>2>>>0]=e.getUTCMinutes(),T[t+8>>>2>>>0]=e.getUTCHours(),T[t+12>>>2>>>0]=e.getUTCDate(),T[t+16>>>2>>>0]=e.getUTCMonth(),T[t+20>>>2>>>0]=e.getUTCFullYear()-1900,T[t+24>>>2>>>0]=e.getUTCDay(),T[t+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},T:function(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),T[t>>>2>>>0]=e.getSeconds(),T[t+4>>>2>>>0]=e.getMinutes(),T[t+8>>>2>>>0]=e.getHours(),T[t+12>>>2>>>0]=e.getDate(),T[t+16>>>2>>>0]=e.getMonth(),T[t+20>>>2>>>0]=e.getFullYear()-1900,T[t+24>>>2>>>0]=e.getDay(),T[t+28>>>2>>>0]=(Se(e.getFullYear())?kt:Nt)[e.getMonth()]+e.getDate()-1|0,T[t+36>>>2>>>0]=-(60*e.getTimezoneOffset());var i=new Date(e.getFullYear(),6,1).getTimezoneOffset(),s=new Date(e.getFullYear(),0,1).getTimezoneOffset();T[t+32>>>2>>>0]=(i!=s&&e.getTimezoneOffset()==Math.min(s,i))|0},U:function(e){e>>>=0;var t=new Date(T[e+20>>>2>>>0]+1900,T[e+16>>>2>>>0],T[e+12>>>2>>>0],T[e+8>>>2>>>0],T[e+4>>>2>>>0],T[e>>>2>>>0],0),i=T[e+32>>>2>>>0],s=t.getTimezoneOffset(),c=new Date(t.getFullYear(),6,1).getTimezoneOffset(),g=new Date(t.getFullYear(),0,1).getTimezoneOffset(),S=Math.min(g,c);return 0>i?T[e+32>>>2>>>0]=+(c!=g&&S==s):0<i!=(S==s)&&(c=Math.max(g,c),t.setTime(t.getTime()+6e4*((0<i?S:c)-s))),T[e+24>>>2>>>0]=t.getDay(),T[e+28>>>2>>>0]=(Se(t.getFullYear())?kt:Nt)[t.getMonth()]+t.getDate()-1|0,T[e>>>2>>>0]=t.getSeconds(),T[e+4>>>2>>>0]=t.getMinutes(),T[e+8>>>2>>>0]=t.getHours(),T[e+12>>>2>>>0]=t.getDate(),T[e+16>>>2>>>0]=t.getMonth(),T[e+20>>>2>>>0]=t.getYear(),BigInt(t.getTime()/1e3)},Q:function(){return-52},R:function(){},J:function(e,t,i){function s(A){return(A=A.toTimeString().match(/\(([A-Za-z ]+)\)$/))?A[1]:"GMT"}i>>>=0;var c=new Date().getFullYear(),g=new Date(c,0,1),S=new Date(c,6,1);c=g.getTimezoneOffset();var v=S.getTimezoneOffset();B[e>>>0>>>2>>>0]=60*Math.max(c,v),T[t>>>0>>>2>>>0]=+(c!=v),e=s(g),t=s(S),e=$t(e),t=$t(t),v<c?(B[i>>>2>>>0]=e,B[i+4>>>2>>>0]=t):(B[i>>>2>>>0]=t,B[i+4>>>2>>>0]=e)},t:()=>{Me("")},C:()=>Date.now(),K:function(){return 4294901760},n:()=>performance.now(),Z:function(e,t,i){return t>>>=0,R.copyWithin(e>>>0>>>0,t>>>0,t+(i>>>0)>>>0)},I:function(e){e>>>=0;var t=R.length;if(4294901760<e)return!1;for(var i=1;4>=i;i*=2){var s=t*(1+.2/i);s=Math.min(s,e+100663296);var c=Math;s=Math.max(e,s);e:{c=(c.min.call(c,4294901760,s+(65536-s%65536)%65536)-M.buffer.byteLength+65535)/65536;try{M.grow(c),C();var g=1;break e}catch{}g=void 0}if(g)return!0}return!1},X:function(e,t){e>>>=0,t>>>=0;var i=0;return Ht().forEach((s,c)=>{var g=t+i;for(c=B[e+4*c>>>2>>>0]=g,g=0;g<s.length;++g)z[c++>>>0>>>0]=s.charCodeAt(g);z[c>>>0>>>0]=0,i+=s.length+1}),0},Y:function(e,t){e>>>=0,t>>>=0;var i=Ht();B[e>>>2>>>0]=i.length;var s=0;return i.forEach(c=>s+=c.length+1),B[t>>>2>>>0]=s,0},w:()=>52,A:function(){return 52},W:function(){return 70},z:function(e,t,i,s){t>>>=0,i>>>=0,s>>>=0;for(var c=0,g=0;g<i;g++){var S=B[t>>>2>>>0],v=B[t+4>>>2>>>0];t+=8;for(var A=0;A<v;A++){var P=R[S+A>>>0],F=xn[e];P===0||P===10?((e===1?L:_)(We(F,0)),F.length=0):F.push(P)}c+=v}return B[s>>>2>>>0]=c,0},ga:Gt,m:function(e,t,i,s){return Gt(e>>>0,t>>>0,i>>>0,s>>>0)}},O=function(){var e={a:Bn};return ne++,Fe(e,function(t){O=t.instance.exports,O=Cn(),M=O.ha,C(),Te.unshift(O.ia),ne--,ne==0&&(G!==null&&(clearInterval(G),G=null),q&&(t=q,q=null,t()))}).catch(a),{}}();n._OrtInit=(e,t)=>(n._OrtInit=O.ja)(e,t),n._OrtGetLastError=(e,t)=>(n._OrtGetLastError=O.ka)(e,t),n._OrtCreateSessionOptions=(e,t,i,s,c,g,S,v,A,P)=>(n._OrtCreateSessionOptions=O.la)(e,t,i,s,c,g,S,v,A,P),n._OrtAppendExecutionProvider=(e,t)=>(n._OrtAppendExecutionProvider=O.ma)(e,t),n._OrtAddFreeDimensionOverride=(e,t,i)=>(n._OrtAddFreeDimensionOverride=O.na)(e,t,i),n._OrtAddSessionConfigEntry=(e,t,i)=>(n._OrtAddSessionConfigEntry=O.oa)(e,t,i),n._OrtReleaseSessionOptions=e=>(n._OrtReleaseSessionOptions=O.pa)(e),n._OrtCreateSession=(e,t,i)=>(n._OrtCreateSession=O.qa)(e,t,i),n._OrtReleaseSession=e=>(n._OrtReleaseSession=O.ra)(e),n._OrtGetInputOutputCount=(e,t,i)=>(n._OrtGetInputOutputCount=O.sa)(e,t,i),n._OrtGetInputName=(e,t)=>(n._OrtGetInputName=O.ta)(e,t),n._OrtGetOutputName=(e,t)=>(n._OrtGetOutputName=O.ua)(e,t),n._OrtFree=e=>(n._OrtFree=O.va)(e),n._OrtCreateTensor=(e,t,i,s,c,g)=>(n._OrtCreateTensor=O.wa)(e,t,i,s,c,g),n._OrtGetTensorData=(e,t,i,s,c)=>(n._OrtGetTensorData=O.xa)(e,t,i,s,c),n._OrtReleaseTensor=e=>(n._OrtReleaseTensor=O.ya)(e),n._OrtCreateRunOptions=(e,t,i,s)=>(n._OrtCreateRunOptions=O.za)(e,t,i,s),n._OrtAddRunConfigEntry=(e,t,i)=>(n._OrtAddRunConfigEntry=O.Aa)(e,t,i),n._OrtReleaseRunOptions=e=>(n._OrtReleaseRunOptions=O.Ba)(e),n._OrtCreateBinding=e=>(n._OrtCreateBinding=O.Ca)(e),n._OrtBindInput=(e,t,i)=>(n._OrtBindInput=O.Da)(e,t,i),n._OrtBindOutput=(e,t,i,s)=>(n._OrtBindOutput=O.Ea)(e,t,i,s),n._OrtClearBoundOutputs=e=>(n._OrtClearBoundOutputs=O.Fa)(e),n._OrtReleaseBinding=e=>(n._OrtReleaseBinding=O.Ga)(e),n._OrtRunWithBinding=(e,t,i,s,c)=>(n._OrtRunWithBinding=O.Ha)(e,t,i,s,c),n._OrtRun=(e,t,i,s,c,g,S,v)=>(n._OrtRun=O.Ia)(e,t,i,s,c,g,S,v),n._OrtEndProfiling=e=>(n._OrtEndProfiling=O.Ja)(e);var Ye=n._malloc=e=>(Ye=n._malloc=O.Ka)(e),ae=n._free=e=>(ae=n._free=O.La)(e),Vt=e=>(Vt=O.Ma)(e);n.__embind_initialize_bindings=()=>(n.__embind_initialize_bindings=O.Na)();var qt=()=>(qt=O.Pa)(),Xt=e=>(Xt=O.Qa)(e),Jt=e=>(Jt=O.Ra)(e);function Cn(){var e=O;e=Object.assign({},e);var t=s=>()=>s()>>>0,i=s=>c=>s(c)>>>0;return e.__errno_location=t(e.__errno_location),e.Ka=i(e.Ka),e.Ma=i(e.Ma),e.Pa=t(e.Pa),e.Ra=i(e.Ra),e}n.stackAlloc=Jt,n.stackSave=qt,n.stackRestore=Xt,n.UTF8ToString=ke,n.stringToUTF8=(e,t,i)=>$e(e,R,t,i),n.lengthBytesUTF8=Ne;var Ve;q=function e(){Ve||Zt(),Ve||(q=e)};function Zt(){if(!(0<ne)){for(;0<fe.length;)fe.shift()(n);if(!(0<ne||Ve||(Ve=!0,n.calledRun=!0,j))){for(;0<Te.length;)Te.shift()(n);for(u(n);0<re.length;)re.shift()(n)}}}return Zt(),r.ready}})();typeof Cr=="object"&&typeof bt=="object"?bt.exports=Br:typeof define=="function"&&define.amd&&define([],()=>Br)});var Tt,Hn,vt,Et,nt,Ur,jn,zn,Gn,Lr,$,Oe=U(()=>{"use strict";Tt=Dr();Hn=Tt,Et=!1,nt=!1,Ur=!1,jn=()=>{try{return typeof SharedArrayBuffer>"u"?!1:(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}},zn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Gn=(o,r)=>o?r?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":r?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Lr=async o=>{if(Et)return Promise.resolve();if(nt)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Ur)throw new Error("previous call to 'initializeWebAssembly()' failed.");nt=!0;let r=o.initTimeout,n=o.numThreads,u=o.simd,a=n>1&&jn(),d=u&&zn(),f=o.wasmPaths,m=typeof f=="string"?f:void 0,h=Gn(d,a),l=typeof f=="object"?f[h]:void 0,y=!1,b=[];if(r>0&&b.push(new Promise(w=>{setTimeout(()=>{y=!0,w()},r)})),b.push(new Promise((w,E)=>{(a?Hn:Tt)({locateFile:(L,_)=>L.endsWith(".wasm")?l||(m??_)+h:_+L}).then(L=>{nt=!1,Et=!0,vt=L,w()},L=>{nt=!1,Ur=!0,E(L)})})),await Promise.race(b),y)throw new Error(`WebAssembly backend initializing failed due to timeout: ${r}ms`)},$=()=>{if(Et&&vt)return vt;throw new Error("WebAssembly is not initialized yet.")}});var H,Ce,k,ot=U(()=>{"use strict";Oe();H=(o,r)=>{let n=$(),u=n.lengthBytesUTF8(o)+1,a=n._malloc(u);return n.stringToUTF8(o,a,u),r.push(a),a},Ce=(o,r,n,u)=>{if(typeof o=="object"&&o!==null){if(n.has(o))throw new Error("Circular reference in options");n.add(o)}Object.entries(o).forEach(([a,d])=>{let f=r?r+a:a;if(typeof d=="object")Ce(d,f+".",n,u);else if(typeof d=="string"||typeof d=="number")u(f,d.toString());else if(typeof d=="boolean")u(f,d?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof d}`)})},k=o=>{let r=$(),n=r.stackSave();try{let u=r.stackAlloc(8);r._OrtGetLastError(u,u+4);let a=r.HEAP32[u/4],d=r.HEAPU32[u/4+1],f=d?r.UTF8ToString(d):"";throw new Error(`${o} ERROR_CODE: ${a}, ERROR_MESSAGE: ${f}`)}finally{r.stackRestore(n)}}});var Mr,Rr=U(()=>{"use strict";Oe();ot();Mr=o=>{let r=$(),n=0,u=[],a=o||{};try{if(o?.logSeverityLevel===void 0)a.logSeverityLevel=2;else if(typeof o.logSeverityLevel!="number"||!Number.isInteger(o.logSeverityLevel)||o.logSeverityLevel<0||o.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${o.logSeverityLevel}`);if(o?.logVerbosityLevel===void 0)a.logVerbosityLevel=0;else if(typeof o.logVerbosityLevel!="number"||!Number.isInteger(o.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${o.logVerbosityLevel}`);o?.terminate===void 0&&(a.terminate=!1);let d=0;return o?.tag!==void 0&&(d=H(o.tag,u)),n=r._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,d),n===0&&k("Can't create run options."),o?.extra!==void 0&&Ce(o.extra,"",new WeakSet,(f,m)=>{let h=H(f,u),l=H(m,u);r._OrtAddRunConfigEntry(n,h,l)!==0&&k(`Can't set a run config entry: ${f} - ${m}.`)}),[n,u]}catch(d){throw n!==0&&r._OrtReleaseRunOptions(n),u.forEach(f=>r._free(f)),d}}});var Yn,Vn,qn,Xn,Fr,Wr=U(()=>{"use strict";Oe();ot();Yn=o=>{switch(o){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${o}`)}},Vn=o=>{switch(o){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${o}`)}},qn=o=>{o.extra||(o.extra={}),o.extra.session||(o.extra.session={});let r=o.extra.session;r.use_ort_model_bytes_directly||(r.use_ort_model_bytes_directly="1"),o.executionProviders&&o.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(o.enableMemPattern=!1)},Xn=(o,r,n)=>{for(let u of r){let a=typeof u=="string"?u:u.name;switch(a){case"xnnpack":a="XNNPACK";break;case"webnn":if(a="WEBNN",typeof u!="string"){let f=u;if(f?.deviceType){let m=H("deviceType",n),h=H(f.deviceType,n);$()._OrtAddSessionConfigEntry(o,m,h)!==0&&k(`Can't set a session config entry: 'deviceType' - ${f.deviceType}.`)}if(f?.numThreads){let m=f.numThreads;(typeof m!="number"||!Number.isInteger(m)||m<0)&&(m=0);let h=H("numThreads",n),l=H(m.toString(),n);$()._OrtAddSessionConfigEntry(o,h,l)!==0&&k(`Can't set a session config entry: 'numThreads' - ${f.numThreads}.`)}if(f?.powerPreference){let m=H("powerPreference",n),h=H(f.powerPreference,n);$()._OrtAddSessionConfigEntry(o,m,h)!==0&&k(`Can't set a session config entry: 'powerPreference' - ${f.powerPreference}.`)}}break;case"webgpu":if(a="JS",typeof u!="string"){let f=u;if(f?.preferredLayout){if(f.preferredLayout!=="NCHW"&&f.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${f.preferredLayout}`);let m=H("preferredLayout",n),h=H(f.preferredLayout,n);$()._OrtAddSessionConfigEntry(o,m,h)!==0&&k(`Can't set a session config entry: 'preferredLayout' - ${f.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${a}`)}let d=H(a,n);$()._OrtAppendExecutionProvider(o,d)!==0&&k(`Can't append execution provider: ${a}.`)}},Fr=o=>{let r=$(),n=0,u=[],a=o||{};qn(a);try{let d=Yn(a.graphOptimizationLevel??"all"),f=Vn(a.executionMode??"sequential"),m=typeof a.logId=="string"?H(a.logId,u):0,h=a.logSeverityLevel??2;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log serverity level is not valid: ${h}`);let l=a.logVerbosityLevel??0;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log verbosity level is not valid: ${l}`);let y=typeof a.optimizedModelFilePath=="string"?H(a.optimizedModelFilePath,u):0;if(n=r._OrtCreateSessionOptions(d,!!a.enableCpuMemArena,!!a.enableMemPattern,f,!!a.enableProfiling,0,m,h,l,y),n===0&&k("Can't create session options."),a.executionProviders&&Xn(n,a.executionProviders,u),a.freeDimensionOverrides)for(let[b,w]of Object.entries(a.freeDimensionOverrides)){if(typeof b!="string")throw new Error(`free dimension override name must be a string: ${b}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let E=H(b,u);r._OrtAddFreeDimensionOverride(n,E,w)!==0&&k(`Can't set a free dimension override: ${b} - ${w}.`)}return a.extra!==void 0&&Ce(a.extra,"",new WeakSet,(b,w)=>{let E=H(b,u),x=H(w,u);r._OrtAddSessionConfigEntry(n,E,x)!==0&&k(`Can't set a session config entry: ${b} - ${w}.`)}),[n,u]}catch(d){throw n!==0&&r._OrtReleaseSessionOptions(n),u.forEach(f=>r._free(f)),d}}});var St,kr,At,Nr,$r,it,Hr,Ot=U(()=>{"use strict";St=o=>{switch(o){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${o}`)}},kr=o=>{switch(o){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${o}`)}},At=o=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][o],Nr=o=>{switch(o){case"float16":return Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${o}`)}},$r=o=>{switch(o){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${o}`)}},it=o=>o==="float32"||o==="int32"||o==="int64"||o==="bool"||o==="float16"||o==="uint32",Hr=o=>{switch(o){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${o}`)}}});var Jn,zr,Gr,De,Zn,Pt,Yr,Vr,jr,qr,Xr,Jr=U(()=>{"use strict";Rr();Wr();Ot();Oe();ot();Jn=(o,r)=>{$()._OrtInit(o,r)!==0&&k("Can't initialize onnxruntime.")},zr=async o=>{Jn(o.wasm.numThreads,$r(o.logLevel))},Gr=async(o,r)=>{},De=new Map,Zn=o=>{let r=$(),n=r.stackSave();try{let u=r.stackAlloc(8);return r._OrtGetInputOutputCount(o,u,u+4)!==0&&k("Can't get session input/output count."),[r.HEAP32[u/4],r.HEAP32[u/4+1]]}finally{r.stackRestore(n)}},Pt=o=>{let r=$(),n=r._malloc(o.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${o.byteLength}.`);return r.HEAPU8.set(o,n),[n,o.byteLength]},Yr=(o,r)=>{let n,u,a=$();Array.isArray(o)?[n,u]=o:o.buffer===a.HEAPU8.buffer?[n,u]=[o.byteOffset,o.byteLength]:[n,u]=Pt(o);let d=0,f=0,m=0,h=[],l=[],y=[];try{[f,h]=Fr(r),d=a._OrtCreateSession(n,u,f),d===0&&k("Can't create a session.");let[b,w]=Zn(d),E=[],x=[],I=[];for(let _=0;_<b;_++){let M=a._OrtGetInputName(d,_);M===0&&k("Can't get an input name."),l.push(M),E.push(a.UTF8ToString(M))}for(let _=0;_<w;_++){let M=a._OrtGetOutputName(d,_);M===0&&k("Can't get an output name."),y.push(M);let j=a.UTF8ToString(M);x.push(j)}let L=null;return De.set(d,[d,l,y,L]),[d,E,x]}catch(b){throw l.forEach(w=>a._OrtFree(w)),y.forEach(w=>a._OrtFree(w)),m!==0&&a._OrtReleaseBinding(m),d!==0&&a._OrtReleaseSession(d),b}finally{a._free(n),f!==0&&a._OrtReleaseSessionOptions(f),h.forEach(b=>a._free(b))}},Vr=o=>{let r=$(),n=De.get(o);if(!n)throw new Error(`cannot release session. invalid session id: ${o}`);let[u,a,d,f]=n;f&&r._OrtReleaseBinding(f.handle),r.jsepUnregisterBuffers?.(o),a.forEach(m=>r._OrtFree(m)),d.forEach(m=>r._OrtFree(m)),r._OrtReleaseSession(u),De.delete(o)},jr=(o,r,n,u,a)=>{if(!o){r.push(0);return}let d=$(),f=o[0],m=o[1],h=o[3],l,y;if(f==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(h==="gpu-buffer"){let E=o[2].gpuBuffer,x=At(St(f));y=m.reduce((I,L)=>I*L,1)*x,l=d.jsepRegisterBuffer(u,a,E,y)}else{let E=o[2];if(Array.isArray(E)){y=4*E.length,l=d._malloc(y),n.push(l);let x=l/4;for(let I=0;I<E.length;I++){if(typeof E[I]!="string")throw new TypeError(`tensor data at index ${I} is not a string`);d.HEAPU32[x++]=H(E[I],n)}}else y=E.byteLength,l=d._malloc(y),n.push(l),d.HEAPU8.set(new Uint8Array(E.buffer,E.byteOffset,y),l)}let b=d.stackSave(),w=d.stackAlloc(4*m.length);try{let E=w/4;m.forEach(I=>d.HEAP32[E++]=I);let x=d._OrtCreateTensor(St(f),l,y,w,m.length,Hr(h));x===0&&k(`Can't create tensor for input/output. session=${u}, index=${a}.`),r.push(x)}finally{d.stackRestore(b)}},qr=async(o,r,n,u,a,d)=>{let f=$(),m=De.get(o);if(!m)throw new Error(`cannot run inference. invalid session id: ${o}`);let[h,l,y,b]=m,w=r.length,E=u.length,x=0,I=[],L=[],_=[],M=[],j=f.stackSave(),z=f.stackAlloc(w*4),R=f.stackAlloc(w*4),oe=f.stackAlloc(E*4),pe=f.stackAlloc(E*4);try{[x,I]=Mr(d);for(let C=0;C<w;C++)jr(n[C],L,M,o,r[C]);for(let C=0;C<E;C++)jr(a[C],_,M,o,w+u[C]);let T=z/4,B=R/4,Ue=oe/4,Le=pe/4;for(let C=0;C<w;C++)f.HEAPU32[T++]=L[C],f.HEAPU32[B++]=l[r[C]];for(let C=0;C<E;C++)f.HEAPU32[Ue++]=_[C],f.HEAPU32[Le++]=y[u[C]];let Pe;Pe=await f._OrtRun(h,R,z,w,pe,E,oe,x),Pe!==0&&k("failed to call OrtRun().");let ue=[];for(let C=0;C<E;C++){let fe=f.HEAPU32[oe/4+C];if(fe===_[C]){ue.push(a[C]);continue}let Te=f.stackSave(),re=f.stackAlloc(4*4),ne=!1,G,q=0;try{f._OrtGetTensorData(fe,re,re+4,re+8,re+12)!==0&&k(`Can't access output tensor data on index ${C}.`);let me=re/4,ce=f.HEAPU32[me++];q=f.HEAPU32[me++];let Ie=f.HEAPU32[me++],Re=f.HEAPU32[me++],he=[];for(let X=0;X<Re;X++)he.push(f.HEAPU32[Ie/4+X]);f._OrtFree(Ie);let le=he.reduce((X,Y)=>X*Y,1);G=kr(ce);let Fe=b?.outputPreferredLocations[u[C]];if(G==="string"){if(Fe==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let X=[],Y=q/4;for(let xe=0;xe<le;xe++){let _e=f.HEAPU32[Y++],We=xe===le-1?void 0:f.HEAPU32[Y]-_e;X.push(f.UTF8ToString(_e,We))}ue.push([G,he,X,"cpu"])}else if(Fe==="gpu-buffer"&&le>0){let X=f.jsepGetBuffer(q),Y=At(ce);if(Y===void 0||!it(G))throw new Error(`Unsupported data type: ${G}`);ne=!0,ue.push([G,he,{gpuBuffer:X,download:f.jsepCreateDownloader(X,le*Y,G),dispose:()=>{f._OrtReleaseTensor(fe)}},"gpu-buffer"])}else{let X=Nr(G),Y=new X(le);new Uint8Array(Y.buffer,Y.byteOffset,Y.byteLength).set(f.HEAPU8.subarray(q,q+Y.byteLength)),ue.push([G,he,Y,"cpu"])}}finally{f.stackRestore(Te),G==="string"&&q&&f._free(q),ne||f._OrtReleaseTensor(fe)}}return b&&f._OrtClearBoundOutputs(b.handle),ue}finally{f.stackRestore(j),L.forEach(T=>f._OrtReleaseTensor(T)),_.forEach(T=>f._OrtReleaseTensor(T)),M.forEach(T=>f._free(T)),x!==0&&f._OrtReleaseRunOptions(x),I.forEach(T=>f._free(T))}},Xr=o=>{let r=$(),n=De.get(o);if(!n)throw new Error("invalid session id");let u=n[0],a=r._OrtEndProfiling(u);a===0&&k("Can't get an profile file name."),r._OrtFree(a)}});var It,Zr,Kr,pi,Qr,en,tn,rn,nn,on,an,xt=U(()=>{"use strict";Ee();Jr();Oe();It=!1,Zr=!1,Kr=!1,pi=typeof document<"u"?document?.currentScript?.src:void 0,Qr=async()=>{if(!Zr){if(It)throw new Error("multiple calls to 'initWasm()' detected.");if(Kr)throw new Error("previous call to 'initWasm()' failed.");It=!0;try{await Lr(N.wasm),await zr(N),Zr=!0}catch(o){throw Kr=!0,o}finally{It=!1}}},en=async o=>{await Gr(N,o)},tn=async o=>Pt(o),rn=async(o,r)=>Yr(o,r),nn=async o=>{Vr(o)},on=async(o,r,n,u,a,d)=>qr(o,r,n,u,a,d),an=async o=>{Xr(o)}});var sn,Qn,at,un=U(()=>{"use strict";Ee();xt();Ot();sn=(o,r)=>{switch(o.location){case"cpu":return[o.type,o.dims,o.data,"cpu"];case"gpu-buffer":return[o.type,o.dims,{gpuBuffer:o.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${o.location} for ${r()}`)}},Qn=o=>{switch(o[3]){case"cpu":return new V(o[0],o[2],o[1]);case"gpu-buffer":{let r=o[0];if(!it(r))throw new Error(`not supported data type: ${r} for deserializing GPU tensor`);let{gpuBuffer:n,download:u,dispose:a}=o[2];return V.fromGpuBuffer(n,{dataType:r,dims:o[1],download:u,dispose:a})}default:throw new Error(`invalid data location: ${o[3]}`)}},at=class{async fetchModelAndCopyToWasmMemory(r){let n=await fetch(r);if(n.status!==200)throw new Error(`failed to load model: ${r}`);let u=await n.arrayBuffer();return tn(new Uint8Array(u))}async loadModel(r,n){be();let u;typeof r=="string"?typeof process<"u"&&process.versions&&process.versions.node?u=await(void 0)(r):u=await this.fetchModelAndCopyToWasmMemory(r):u=r,[this.sessionId,this.inputNames,this.outputNames]=await rn(u,n),ve()}async dispose(){return nn(this.sessionId)}async run(r,n,u){be();let a=[],d=[];Object.entries(r).forEach(w=>{let E=w[0],x=w[1],I=this.inputNames.indexOf(E);if(I===-1)throw new Error(`invalid input '${E}'`);a.push(x),d.push(I)});let f=[],m=[];Object.entries(n).forEach(w=>{let E=w[0],x=w[1],I=this.outputNames.indexOf(E);if(I===-1)throw new Error(`invalid output '${E}'`);f.push(x),m.push(I)});let h=a.map((w,E)=>sn(w,()=>`input "${this.inputNames[d[E]]}"`)),l=f.map((w,E)=>w?sn(w,()=>`output "${this.outputNames[m[E]]}"`):null),y=await on(this.sessionId,d,h,m,l,u),b={};for(let w=0;w<y.length;w++)b[this.outputNames[m[w]]]=f[w]??Qn(y[w]);return ve(),b}startProfiling(){}endProfiling(){an(this.sessionId)}}});var eo,st,fn=U(()=>{"use strict";Ee();xt();un();eo=()=>{if((typeof N.wasm.initTimeout!="number"||N.wasm.initTimeout<0)&&(N.wasm.initTimeout=0),typeof N.wasm.simd!="boolean"&&(N.wasm.simd=!0),typeof N.wasm.proxy!="boolean"&&(N.wasm.proxy=!1),typeof N.wasm.trace!="boolean"&&(N.wasm.trace=!1),typeof N.wasm.numThreads!="number"||!Number.isInteger(N.wasm.numThreads)||N.wasm.numThreads<=0){let o=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;N.wasm.numThreads=Math.min(4,Math.ceil((o||1)/2))}},st=class{async init(r){eo(),await Qr(),await en(r)}async createInferenceSessionHandler(r,n){let u=new at;return await u.loadModel(r,n),Promise.resolve(u)}}});var cn={};qe(cn,{wasmBackend:()=>to});var to,ln=U(()=>{"use strict";fn();to=new st});Ee();Ee();Ee();var Or="1.17.0";var Di=wt;{let o=(ln(),mt(cn)).wasmBackend;Ae("cpu",o,10),Ae("wasm",o,10),Ae("xnnpack",o,9)}Object.defineProperty(N.versions,"web",{value:Or,enumerable:!0});export{Fn as InferenceSession,wr as TRACE,be as TRACE_FUNC_BEGIN,ve as TRACE_FUNC_END,V as Tensor,kn as TrainingSession,Di as default,N as env,Ae as registerBackend};
//# sourceMappingURL=ort.wasm-core.min.js.map
